{
  "analysis_metadata": {
    "generated_date": "2025-07-14T14:00:00Z",
    "phase": "Phase 3 - Terraform Cluster Konsolidierung",
    "total_terraform_commands": 6,
    "analysis_scope": "Funktionsüberschneidungen und Konsolidierungspotential",
    "author": "Claude Code Phase 3 Analysis"
  },
  "terraform_commands_analysis": [
    {
      "command": "/terraform-validate",
      "current_functionality": [
        "Check working directory",
        "terraform fmt -recursive", 
        "terraform validate",
        "terraform plan -out=tfplan",
        "Show errors/warnings",
        "Provide summary"
      ],
      "complexity": "Low",
      "usage_frequency": "Daily",
      "execution_time": "30-60 seconds",
      "overlap_score": "High"
    },
    {
      "command": "/tf-flow", 
      "current_functionality": [
        "Check directory structure",
        "terraform fmt -recursive",
        "terraform validate", 
        "terraform plan",
        "Save plan to tfplan",
        "Comprehensive summary",
        "Auto-detect terraform/ subdirectory"
      ],
      "complexity": "Medium",
      "usage_frequency": "Daily",
      "execution_time": "45-90 seconds", 
      "overlap_score": "Very High"
    },
    {
      "command": "/tf-apply",
      "current_functionality": [
        "Pre-deployment validation",
        "Security checks",
        "terraform apply -auto-approve",
        "Monitor progress",
        "Post-deployment verification",
        "Deployment summary"
      ],
      "complexity": "Medium",
      "usage_frequency": "Daily",
      "execution_time": "Variable (1-10 minutes)",
      "overlap_score": "Medium"
    },
    {
      "command": "/tf-destroy",
      "current_functionality": [
        "Pre-destruction validation",
        "Safety checks and warnings",
        "terraform plan -destroy",
        "terraform destroy -auto-approve",
        "Post-destruction verification",
        "Destruction summary"
      ],
      "complexity": "Medium", 
      "usage_frequency": "Weekly",
      "execution_time": "Variable (30 seconds - 5 minutes)",
      "overlap_score": "Low"
    },
    {
      "command": "/tf-pre-commit",
      "current_functionality": [
        "Pre-validation setup",
        "Core pre-commit execution",
        "Multiple hook types",
        "Error analysis",
        "Automatic fixes (--fix)",
        "Verbose reporting"
      ],
      "complexity": "High",
      "usage_frequency": "Daily",
      "execution_time": "60-120 seconds",
      "overlap_score": "Medium"
    },
    {
      "command": "/tf-security-scan",
      "current_functionality": [
        "Pre-apply security validation",
        "Wiz Platform integration",
        "Multiple security tools",
        "Compliance framework checks",
        "Risk scoring",
        "Enforcement levels"
      ],
      "complexity": "High",
      "usage_frequency": "Daily", 
      "execution_time": "90-180 seconds",
      "overlap_score": "Low"
    }
  ],
  "overlap_analysis": {
    "high_overlap_cluster": {
      "commands": ["/terraform-validate", "/tf-flow"],
      "overlap_percentage": 85,
      "shared_functionality": [
        "terraform fmt -recursive",
        "terraform validate", 
        "terraform plan",
        "Error reporting",
        "Directory detection"
      ],
      "differences": [
        "/tf-flow has better directory auto-detection",
        "/tf-flow provides more comprehensive reporting",
        "/terraform-validate is simpler and faster"
      ],
      "consolidation_recommendation": "MERGE - /tf-flow subsumes /terraform-validate completely"
    },
    "medium_overlap_cluster": {
      "commands": ["/tf-apply", "/tf-pre-commit"],
      "overlap_percentage": 35,
      "shared_functionality": [
        "Pre-deployment validation",
        "Security checks",
        "Error handling"
      ],
      "differences": [
        "/tf-apply focuses on deployment",
        "/tf-pre-commit focuses on code quality", 
        "Different use cases and timing"
      ],
      "consolidation_recommendation": "KEEP SEPARATE - Different purposes"
    },
    "low_overlap_cluster": {
      "commands": ["/tf-destroy", "/tf-security-scan"],
      "overlap_percentage": 15,
      "shared_functionality": [
        "Terraform state validation",
        "Safety checks"
      ],
      "differences": [
        "Completely different purposes",
        "Different timing in workflow",
        "Different user intents"
      ],
      "consolidation_recommendation": "KEEP SEPARATE - Unique functions"
    }
  },
  "workflow_analysis": {
    "daily_terraform_workflow": [
      "1. /tf-pre-commit (before git commit)",
      "2. /terraform-validate OR /tf-flow (development cycle)",
      "3. /tf-security-scan (before deployment)",
      "4. /tf-apply (deployment)",
      "5. /tf-destroy (cleanup, optional)"
    ],
    "redundancy_points": [
      {
        "step": "Validation",
        "commands": ["/terraform-validate", "/tf-flow", "/tf-pre-commit"],
        "redundancy_level": "High",
        "impact": "Users confused about which validation to use"
      },
      {
        "step": "Planning", 
        "commands": ["/terraform-validate", "/tf-flow"],
        "redundancy_level": "Very High",
        "impact": "Complete functional duplication"
      }
    ]
  },
  "consolidation_strategy": {
    "tier_1_merge": {
      "action": "MERGE /terraform-validate INTO /tf-flow",
      "rationale": "85% overlap, /tf-flow is superior in every aspect",
      "implementation": "Rename /tf-flow to /tf-validate, archive old /terraform-validate",
      "benefits": [
        "Eliminates confusion between similar commands",
        "Preserves familiar /tf-validate name",
        "Keeps superior functionality of /tf-flow"
      ],
      "risks": "Low - /tf-flow is superset of /terraform-validate"
    },
    "tier_2_enhancement": {
      "action": "ENHANCE /tf-apply WITH SAFETY",
      "rationale": "Current /tf-apply uses -auto-approve which is dangerous",
      "implementation": "Add optional --confirm flag, improve safety checks",
      "benefits": [
        "Safer deployment workflow",
        "Better error handling", 
        "Maintains automation option"
      ],
      "risks": "Medium - Changes existing behavior"
    },
    "tier_3_specialization": {
      "action": "KEEP SPECIALIZED COMMANDS",
      "commands": ["/tf-destroy", "/tf-pre-commit", "/tf-security-scan"],
      "rationale": "Unique purposes, low overlap, high value",
      "implementation": "No changes needed",
      "benefits": "Maintains specialized functionality",
      "risks": "None"
    }
  },
  "proposed_final_structure": {
    "core_commands": [
      {
        "name": "/tf-validate",
        "description": "Comprehensive Terraform workflow (fmt, validate, plan)",
        "replaces": ["/terraform-validate", "/tf-flow"],
        "usage": "Daily development cycle"
      },
      {
        "name": "/tf-deploy", 
        "description": "Enhanced deployment with safety checks",
        "replaces": ["/tf-apply"],
        "usage": "Production deployment"
      },
      {
        "name": "/tf-destroy",
        "description": "Safe infrastructure destruction", 
        "replaces": "None",
        "usage": "Cleanup operations"
      }
    ],
    "specialized_commands": [
      {
        "name": "/tf-pre-commit",
        "description": "Pre-commit hook validation",
        "replaces": "None", 
        "usage": "Git workflow integration"
      },
      {
        "name": "/tf-security-scan",
        "description": "Advanced security scanning",
        "replaces": "None",
        "usage": "Security validation"
      }
    ]
  },
  "implementation_plan": {
    "step_1": {
      "action": "Create enhanced /tf-validate",
      "details": "Combine best features of /terraform-validate and /tf-flow",
      "time_estimate": "30 minutes"
    },
    "step_2": {
      "action": "Create enhanced /tf-deploy", 
      "details": "Upgrade /tf-apply with safety features",
      "time_estimate": "45 minutes"
    },
    "step_3": {
      "action": "Archive replaced commands",
      "details": "Move /terraform-validate and /tf-apply to replaced/",
      "time_estimate": "10 minutes"
    },
    "step_4": {
      "action": "Update documentation",
      "details": "Update CLAUDE.md with new structure",
      "time_estimate": "15 minutes"
    }
  },
  "roi_projection": {
    "command_reduction": "6 → 5 commands (-16%)",
    "complexity_reduction": "30% (eliminate overlap confusion)",
    "safety_improvement": "50% (better deployment safety)",
    "user_experience": "+40% (clearer command purposes)",
    "maintenance_effort": "-25% (fewer commands to maintain)"
  }
}